{"version":3,"sources":["utils.js"],"names":["layui","define","exports","_","lodash","axios","msg","utils","value","validList","error","flag","console","item","index","localStorage","getItem","key","JSON","parse","data","_typeof","setItem","d","removeItem","find","arr","callback","findKey","tplLoader","url","onerror","that","this","indexOf","Date","getTime","time","res","hasq","regList","match","ids","forEach","push","filters","length","undefined","matchResult","result","regStr","substring","RegExp","replace","reg","randomCode","catch","request","statusText","log","errorMsg","interval","setUrlState","title","clearInterval","Math","random","toString","substr","history","pushState","obj","isFunction"],"mappings":";oOAAAA,MAAMC,OAAO,CAAC,SAAU,SAAU,SAASC,GACzC,IAAIC,EAAIH,MAAMI,OACZC,EAAQL,MAAMK,MAoGbH,EAnGS,QAAA,CAHRD,MAAO,SAAAK,GACPH,QAAUC,MAAdE,IAEIC,MAAAA,SAAQC,EAAAC,GACRC,IAAOC,GAAA,EAMH,OALFC,EAAAA,QAAQF,EAAR,SAAAG,EAAAC,GAFMD,IAAAL,IAIDG,GAAA,KAGCE,GAGLE,aAJD,CAKAC,QAAA,SAAAC,GAXM,OAAAC,KAAAC,MAAAJ,aAAAC,QAAAC,KAcRF,QAAAA,SAAcE,EAAAG,GACZJ,IAAAA,EAAS,iBAAA,IAAAI,EAAA,YAAAC,QAAAD,KAAc,gBAAAA,EACrBF,KAAOA,UAAWH,GAAAA,EAFRA,aAAAO,QAAAL,EAAAM,IAKVC,WAAS,SAAAP,GAETF,aAAaO,WAAaC,IAE5BC,MAAAA,WACET,aAAaS,UAejBC,KAAM,SAASC,EAAKC,GAClB,OAAOD,EAAIvB,EAAEyB,QAAQF,EAAKC,KAA1BE,UAAW1B,SAAA2B,EAAAH,EAAJI,GAxCD,IAAAC,EAAAC,KA0CRb,EAAA,GACAS,GAAyBF,IAAdG,EAAAI,QAAA,KACLF,GAAO,IAAXG,MAAAC,UACAN,GAAIV,EAAJ,MAAAiB,EAAA,MAAAA,EAEAhC,EAAIgC,IAAAA,GAAWF,KAAJ,SAAAG,GACbR,EAAOS,EAAAA,KACP,IAAAC,EAAA,GAEEpB,EAAOkB,EAAPG,MAAA,eACID,OAAJE,GAAAvC,EAAAwC,QAAAD,EAAA,SAAA7B,GAAA2B,EAAAI,KAAA/B,KAEA,IAAI6B,EAAMtB,EAAKqB,MAAM,uBACrB,OAAAC,GAAkBC,EAAAA,QAAFE,EAAe,SAAehC,GAAA2B,EAAAI,KAAA/B,KAA9C,EAAA2B,EAAAM,QAEA3C,EAAI0C,QAAAA,EAAeJ,SAAM5B,GACzBgC,IAAAA,EAAsBF,EAAAA,MAAQE,WAA0BL,QAAAO,IAAAP,GAAA,MAAAQ,GAAA,EAAAA,EAAAF,OAAA,CAAxD,IAAAG,EAAAD,EAAA,GAQUE,EAASD,EAAOE,UAAU,EAAGF,EAAOH,OAAS,GANnDN,EAAQM,IAARM,OAAoBF,EAAA,KACtB9B,EAAAA,EAAAiC,QAAAC,EAAAtB,EAAAuB,mBAKIC,MAAA,SAAIN,GACJ,IAAAO,EAAIH,EAAUF,QACdhC,EAAOA,iBAAkBY,EAAKuB,OAA9B,UAAAE,EAAAC,WACD9C,QAAA+C,IAAAC,GAPH,mBAAA7B,GAAAA,EAAA6B,KAYF,IAAAC,EAAIJ,YAAgBA,WAChBG,KAAAA,IACJhD,cAAYgD,GACZjC,EAAOI,KAQN,KAJD+B,YAAI1C,SAAa2C,EAAAjC,GACfkC,QAAAA,UAAcH,GAAAA,EAAd/B,IAGHyB,WALD,WAhFQ,MAAA,IAAAU,KAAAC,SAAAC,SAAA,IAAAC,OAAA,IAwFRC,WAAQC,SAAUC,GAxFV,MAAA,mBAAAA,GA2FVhB,SAAAA,SAAYgB,GACV,MAAkBL,iBAALD,GAEfO,SAAAA,SAAYD,GACV,MAAsB,iBAAf,IAAOA,EAAP,YAAAlD,QAAOkD","file":"utils.js","sourcesContent":["layui.define(['lodash', 'axios'], function(exports) {\r\n  var _ = layui.lodash,\r\n    axios = layui.axios;\r\n  var utils = {\r\n      error: function(msg) {\r\n        console.error(msg);\r\n      },\r\n      oneOf: function(value, validList) {\r\n        var flag = false;\r\n        _.forEach(validList, function(item, index) {\r\n          if (item === value) {\r\n            flag = true;\r\n          }\r\n        })\r\n        return flag;\r\n      },\r\n      // 本地存储相关 \r\n      localStorage: {\r\n        getItem: function(key) {\r\n          return JSON.parse(localStorage.getItem(key));\r\n        },\r\n        setItem: function(key, data) {\r\n          var d = (typeof data === 'object' || typeof data === 'array') ?\r\n            JSON.stringify(data) : data;\r\n          localStorage.setItem(key, d);\r\n        },\r\n        removeItem: function(key) {\r\n          localStorage.removeItem(key);\r\n        },\r\n        clear: function() {\r\n          localStorage.clear();\r\n        }\r\n      },\r\n      /**\r\n       * 在一个数组里面查询一个对象\r\n       * var r = 1;\r\n       * var arr = [{name:'a',id:1},{name:'b',id:2}]\r\n       * var result = utils.find(arr,function(item){\r\n       *   return r === item.id;\r\n       * });\r\n       *  // result : {name:'a',id:1}\r\n       */\r\n      find: function(arr, callback) {\r\n        return arr[_.findKey(arr, callback)];\r\n      },\r\n      // 读取模板\r\n      tplLoader: function(url, callback, onerror) {\r\n        var that = this;\r\n        var data = '';\r\n        var hasq = url.indexOf('?') !== -1;\r\n        var time = new Date().getTime();\r\n      url += hasq ? '&v=' + time : '?v=' + time;\r\n      // TODO 跨域未实现\r\n      axios.get(url).then(function(res) {\r\n        data = res.data;\r\n        var regList = [];\r\n        // 重置id 防止冲突\r\n        var ids = data.match(/id=\\\"\\w*\\\"/g);\r\n        ids !== null && _.forEach(ids, function(item) { regList.push(item); });\r\n        // 重置lay-filter 防止冲突\r\n        var filters = data.match(/lay-filter=\\\"\\w*\\\"/g);\r\n        filters !== null && _.forEach(filters, function(item) { regList.push(item); });\r\n\r\n        if (regList.length > 0) {\r\n          // 循环替换\r\n          _.forEach(regList, function(item) {\r\n            var matchResult = item.match(/\\\"\\w*\\\"/);\r\n            if (matchResult !== undefined && matchResult != null && matchResult.length > 0) {\r\n              var result = matchResult[0];\r\n              var regStr = result.substring(1, result.length - 1);\r\n              var reg = new RegExp(regStr, 'g');\r\n              data = data.replace(reg, that.randomCode());\r\n            }\r\n          });\r\n        }\r\n      })\r\n      .catch(function(error) {\r\n        var request = error.request;\r\n        var errorMsg = '读取模板出现异常，异常代码：' + request.status + '、 异常信息：' + request.statusText;\r\n        console.log(errorMsg);\r\n        typeof onerror === 'function' && onerror(errorMsg);\r\n      });\r\n\r\n      var interval = setInterval(function() {\r\n        if (data !== '') {\r\n          clearInterval(interval);\r\n          callback(data);\r\n        }\r\n      }, 50);\r\n    },\r\n    setUrlState: function(title, url) {\r\n      history.pushState({}, title, url);\r\n    },\r\n    // 获取随机字符\r\n    randomCode: function() {\r\n      return 'r' + Math.random().toString(36).substr(2);\r\n    },\r\n    isFunction: function(obj) {\r\n      return typeof obj === 'function';\r\n    },\r\n    isString: function(obj) {\r\n      return typeof obj === 'string';\r\n    },\r\n    isObject: function(obj) {\r\n      return typeof obj === 'object';\r\n    }\r\n};\r\n//输出utils接口\r\nexports('utils', utils);\r\n});"]}